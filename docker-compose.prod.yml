services:
  platform:
    build: .
    ports:
      - "8075:8080"
    environment:
      PORT: 8080
      WORKERS: ${WORKERS:-500}
      FINGERPRINT: ${FINGERPRINT:-chrome}
      CAPTCHA_API_KEY: ${CAPTCHA_API_KEY}
      PROXY_TOKEN: ${PROXY_TOKEN}
      UPSTREAM_PROXY: ${UPSTREAM_PROXY:-}
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    restart: unless-stopped
    deploy:
      resources:
        limits:
          cpus: "2"
          memory: 1G
