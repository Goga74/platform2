services:
  platform:
    build: .
    ports:
      - "8075:8080"
    environment:
      PORT: 8080
      WORKERS: ${WORKERS:-500}
      FINGERPRINT: ${FINGERPRINT:-chrome}
      STRIKE2_CAPTCHA_KEY: ${STRIKE2_CAPTCHA_KEY}
      STRIKE2_PROXY_TOKEN: ${STRIKE2_PROXY_TOKEN}
      STRIKE2_UPSTREAM_PROXY: ${STRIKE2_UPSTREAM_PROXY:-}
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    restart: unless-stopped
    deploy:
      resources:
        limits:
          cpus: "2"
          memory: 1G
